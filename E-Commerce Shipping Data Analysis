Database used : https://www.kaggle.com/datasets/prachi13/customer-analytics
Queried with : MySQL 
--CALCULATE THE AVERAGE RATING GIVEN BY CUSTOMERS FOR EACH MODE OF SHIPMENT--
SELECT SHIPMENT_MODE, ROUND(AVG(CUSTOMER_RATING),2) AS AVERAGE_RATING
FROM ECOMMERCE_SHIP
GROUP BY SHIPMENT_MODE; 

--DETERMINE THE TOTAL NUMBER OF CUSTOMER CARE CALLS MADE BY CUSTOMERS FOR EACH WAREHOUSE BLOCK--
SELECT WAREHOUSE_BLOCK, COUNT(CUSTOMER_CARE_CALLS) AS N_CARE_CALLS 
FROM ECOMMERCE_SHIP 
GROUP BY WAREHOUSE_BLOCK
ORDER BY N_CARE_CALLS ASC;

--FIND OUT THE AVERAGE DISCOUNT OFFERED FOR DIFFERENT LEVELS OF CUSTOMER RATINGS--
SELECT CUSTOMER_RATING, ROUND(AVG(DISCOUNT_OFFERED),2) AS AVERAGE_DISCOUNT 
FROM ECOMMERCE_SHIP 
GROUP BY CUSTOMER_RATING
ORDER BY CUSTOMER_RATING ASC; 

--CALCULATE THE PERCENTAGE OF ORDERS THAT REACHED ON TIME FOR EACH MODE OF SHIPMENT--
SELECT
   SHIPMENT_MODE,
    SUM(CASE WHEN REACHED_ON_TIME = 'Y' THEN 1 ELSE 0 END) AS ON_TIME_SHIPMENT,
    COUNT(*) AS TOTAL_ORDERS,
    (SUM(CASE WHEN REACHED_ON_TIME = 'Y' THEN 1 ELSE 0 END) / COUNT(*)) * 100 AS ONTIMEPERCENTAGE
FROM 
    ECOMMERCE_SHIP
GROUP BY 
  SHIPMENT_MODE;

--ORDER WAREHOUSE BLOCKS BY THEIR ON TIME DELIVERY--
SELECT WAREHOUSE_BLOCK, COUNT(REACHED_ON_TIME) AS BEST_DELIVERY 
FROM ECOMMERCE_SHIP 
WHERE REACHED_ON_TIME = 1 
GROUP BY WAREHOUSE_BLOCK
ORDER BY BEST_DELIVERY DESC; 

--CALCULATE THE AVERAGE COST OF PRODUCTS BASED ON THEIR IMPORTANCE LEVEL--
SELECT PRODUCT_IMPORTANCE, AVG(COST_OF_PODUCT) AS AVERAGE_COST
FROM ECOMMERCE_SHIP
GROUP BY PRODUCT_IMPORTANCE; 

--DETERMINE THE MOST COMMON MODE OF SHIPMENT FOR PRODUCTS OF DIFFERENT IMPORTANCE LEVELS--
SELECT PRODUCT_IMPORTANCE, COUNT(SHIPMENT_MODE) AS MOST_COMMON, SHIPMENT_MODE
FROM ECOMMERCE_SHIP
GROUP BY PRODUCT_IMPORTANCE, SHIPMENT_MODE
ORDER BY MOST_COMMON DESC ; 

--ANALYZE THE RELATIONSHIP BETWEEN CUSTOMER RATINGS AND THE NUMBER OF PRIOR PURCHASES--
SELECT 
    PRIOR_PURCHASES, ROUND(AVG(CUSTOMER_RATING), 2) AS AVG_CUSTOMER_RATING, 
    COUNT(*) AS NUM_CUSTOMERS
FROM 
    ECOMMERCE_SHIP 
GROUP BY 
    PRIOR_PURCHASES
ORDER BY 
    PRIOR_PURCHASES;

--CALCULATE THE AVERAGE DISCOUNT OFFERED FOR PRODUCTS THAT REACHED ON TIME VS. DELAYED SHIPMENTS--
SELECT AVG(DISCOUNT_OFFERED) AS AVERAGE_DISCOUNT, 
CASE WHEN REACHED_ON_TIME = 1 THEN 'ON TIME'
WHEN REACHED_ON_TIME = 0 THEN 'DELAY' 
ELSE 'NOTHING' END AS STATUS
FROM ECOMMERCE_SHIP
GROUP BY STATUS; 

--DETERMINE THE AVERAGE WEIGHT OF PRODUCTS ORDERED BY MALE VS. FEMALE CUSTOMERS--
SELECT GENDER,ROUND(AVG(WEIGHT_IN_GMS),2) AS AVERAGE_WEIGHT 
FROM ECOMMERCE_SHIP 
GROUP BY GENDER;

--IDENTIFY THE TOP 5 PRODUCTS WITH THE HIGHEST CUSTOMER RATINGS--
SELECT ID, AVG(CUSTOMER_RATING) AS AVERAGE_RATING
FROM ECOMMERCE_SHIP 
GROUP BY ID 
ORDER BY AVERAGE_RATING DESC 
LIMIT 5 ;
